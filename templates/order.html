<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - FruitBasket</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

    <div class="navbar">
        <h1 onclick="window.location.href='/'" style="cursor: pointer;">üçè FruitBasket</h1>
        <ul>
            <li><a href="{{ url_for('home') }}">Home</a></li>
            <li><a href="{{ url_for('aboutus') }}">About us</a></li>
            <li><a href="{{ url_for('shop') }}">Shop</a></li>
            <li><a href="{{ url_for('contact') }}">Contact</a></li>
            <li class="cart-link"><a href="{{ url_for('cart') }}">Cart <span class="cart-badge">0</span></a></li>
        </ul>
    </div>

    <div class="section" style="margin-top: 120px;">
        <h2>Complete Your Order üõí</h2>
        
        <div class="order-summary" style="margin-bottom: 30px;">
            <h3 style="color: #667eea; font-size: 1.8rem; margin-bottom: 20px;">Order Summary</h3>
            <div id="order-items">
                <!-- Order items will be rendered here -->
            </div>
            <div class="order-total" id="order-total">
                Total: ‚Ç±0.00
            </div>
        </div>

        <div class="payment-info" style="margin-top: 40px; padding: 30px; background: #f9f9f9; border-radius: 15px;">
            <h3 style="color: #667eea; font-size: 1.8rem; margin-bottom: 20px;">Shipping & Payment Information</h3>
            <form action="{{ url_for('home') }}" method="GET" onsubmit="return handleOrder(event)">
                <div class="form-group">
                    <label>Full Name *</label>
                    <input type="text" name="name" placeholder="Enter your full name" required />
                </div>
                
                <div class="form-group">
                    <label>Email Address *</label>
                    <input type="email" name="email" placeholder="Enter your email" required />
                </div>
                
                <div class="form-group">
                    <label>Shipping Address *</label>
                    <textarea name="address" rows="3" placeholder="Enter your complete shipping address" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Phone Number *</label>
                    <input type="tel" name="phone" placeholder="Enter your phone number" required />
                </div>

                <div class="form-group">
                    <label>Payment Method</label>
                    <select name="payment" required style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1rem;">
                        <option value="">Select payment method</option>
                        <option value="cash">Cash on Delivery</option>
                        <option value="gcash">GCash</option>
                        <option value="paypal">PayPal</option>
                        <option value="card">Credit/Debit Card</option>
                    </select>
                </div>
                
                <button type="submit" class="btn" style="width: 100%; font-size: 1.2rem; padding: 18px; margin-top: 20px;">
                    Place Order & Pay
                </button>
            </form>
        </div>
    </div>

    <div style="flex: 1;"></div>

    <div class="footer">
        <p>¬© 2025 FruitBasket | Designed with ‚ù§Ô∏è</p>
    </div>

    <script src="{{ url_for('static', filename='cart.js') }}"></script>
    <script>
        // Display order items from cart
        window.onload = function() {
            displayOrderItems();
        };

        function displayOrderItems() {
            const orderItemsContainer = document.getElementById('order-items');
            const orderTotalElement = document.getElementById('order-total');
            
            if (!orderItemsContainer) return;

            const cartData = localStorage.getItem('shoppingCart');
            const items = cartData ? JSON.parse(cartData) : [];
            
            if (items.length === 0) {
                orderItemsContainer.innerHTML = `<p style="text-align: center; color: #666; padding: 20px;">Your cart is empty. <a href="${window.location.origin}/shop">Go shopping</a></p>`;
                return;
            }

            orderItemsContainer.innerHTML = items.map(item => `
                <div style="display: flex; justify-content: space-between; padding: 15px; background: white; margin-bottom: 10px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                    <div>
                        <div style="font-weight: bold; color: #667eea; margin-bottom: 5px;">${item.name}</div>
                        <div style="color: #666;">Quantity: ${item.quantity}</div>
                    </div>
                    <div style="font-weight: bold; font-size: 1.2rem; color: #f5576c;">
                        ‚Ç±${(item.price * item.quantity).toFixed(2)}
                    </div>
                </div>
            `).join('');

            const total = items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            if (orderTotalElement) {
                orderTotalElement.textContent = `Total: ‚Ç±${total.toFixed(2)}`;
            }
        }

        function handleOrder(event) {
            const form = event.target;
            const name = form.querySelector('[name="name"]').value;
            
            cart.clearCart();
            cart.showNotification(`Order placed successfully! Thank you, ${name}!`);
            
            setTimeout(() => {
                window.location.href = form.action;
            }, 2000);
            
            return false;
        }
    </script>
</body>
</html>
